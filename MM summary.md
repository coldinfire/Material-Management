### MM常用透明表
![MM Table](https://i.imgur.com/gTJHkLC.png)

	MARA : 物料主数据表      MARC : 物料工厂(在途库存)    MSKA : 销售订单库存     EKKO : 采购订单抬头
	MAKT : 物料描述          MARD : 物料库存(当前库存)   T001L : 工厂库位关系表   EKPO : 采购订单明细
	MARM : 物料的计量单位    MARDH : 历史库存            T001W : 工厂表          EBAN : 采购申请抬头
	MBEW : 物料评估/价格     MSKU : 第三方库存表         MVKE : 物料的销售数据    EBKN : 采购申请明细
	MKPF : 物料凭证抬头      MSEG : 物料凭证明细         MVVE : 物料的销售数据 
### MM配置
![MM配置](https://i.imgur.com/tVQP3sb.jpg)
###    MRP(物料需求计划):、
![MRP原理](https://i.imgur.com/vAFCJk6.png)
![MRP](https://i.imgur.com/eBxAP09.png)

## 概览
----------
    1. SAP MM简介
    2. 企业组织结构
    3. 物料主数据
    4. 供应商主数据
    5. 采购管理
    6. 发票校验
    7. 库存管理
    8. 报表分析
### MM简介
	业务：
		(采购询价ME41/报价ME47录入、ME49报价比较)---->采购申请(PR)---->采购订单(PO)---->
		发送采购单给供应商<ME9F>---->采购收货(产生物料凭证)---->发票校验(产生会计凭证)---->应付
    买物料（Purchasing、Invoicing）
    基本数据管理：物料、供应商、采购信息、货源、配额、批次数据
    采购管理：采购申请、货源确定、采购批准、采购订单处理、订单跟踪、采购货物接收
    采购发票校验：订单、收货单、发票数量、金额匹配
    库存管理：库存事务处理、库存状态控制、库存分析与评估
    仓库管理：
### 业务流程
	1、SAP物流相关模块中，工厂是最重要的组织结构，隶属于公司代码，并且包括了和物流管理相关的最多的控制参数。这里首先创建一个工厂。
	2、创建工厂下面的3个库存地点：仓库、生产、运输。
	3、创建采购组织，再创建两个采购组：原材料和运营供应、贸易商品
	（注意：此时采购组织以及采购组和公司代码没有任何联系，采购组织和采购组也并没有联系，
	 实际上，采购组在client层次，client下的任何公司，任何工厂都可以使用这个采购组）；
	 定义与工厂相关的两个MRP控制者，分别控制自制品计划和贸易商品的计划。
	4、将创建的工厂分配给公司代码。
	5、分配采购组织到公司代码。
	6、分配工厂到采购组织。SAP系统SAP中的一个采购组织可以同时负责几个工厂的采购。
	7、定义三个物料组：0001原材料、0002产成品和0003贸易商品。在维护主数据的时候，需要分配物料组。
	8、定义计划边际码。这个操作满足这样一种情况：公司除了正常的采购和生产时间，还规定在操作、产前、产后和订单下达各阶段预留一天的缓冲时间。
     这样的规则被定义在“计划边际码”中。
	9、工厂中有很多控制参数。如在库存管理中，对库存物料可以通过预留号进行预留，比如预留给生产订单或者销售订单。
     设定该工厂对于库存的预留允许比计划日期提前一个月使用，同时过期一个月以内的预留仍然可以使用。
	10、维护和库存相关的工厂参数-自动创建物料的库存地点视图。只有某个视图被定义了，才可以对这个物料进行某项操作.
	11、由于公司收到的发票大多是17%的增值税发票，因此这里我们可以把它设为缺省值，方便发票校验。因此我们可以在此处维护税务代码的缺省值。
	12、物料管理在SAP中只能开当月的账，或者至多当月或者上个月的账，而且开账只允许一个月一个月往后开，因此一开始我们要设定一个初始期间。
		一般初始期间设为上线前的那个月，如12月上线，就设定初始日期为11月，在11月中导入期末库存余额。
	13、维护和物料需求计划相关的工厂参数。这部分涉及的参数很多，首先可以采用先复制0001的，再更改不适用的参数。
	14、此处激活物料需求计划MRP这项功能，通过后台的配置实现。
	15、此处定义计划运行的号码范围。运行物料需求计划会产生很多凭证，比如计划订单、非独立需求等，这些凭证都有它们的编号范围。
		在13步复制0001的时候，这些编号范围都已经复制了，这里只需要进行检查。
	16、物料类型是定义物料主数据的最重要的一个参数。它决定了各类物料主数据需要维护哪些信息和参数，物料主数据的编号范围等。
		公司决定使用SAP标准的物料类型：HAWA贸易商品、ROH原材料、FERT产成品。	
	17、定义评估控制，激活按“评估分组代码”来定义科目，这样可以当集团公司有很多工厂时候，而它们的记账规则又是一样，不用一个一个的进行维护，
	    而是将工厂集合成组统一来定义记账规则。
	18、将之前定义的工厂归入我们的CN01评估分组代码，这样以后该集团增加工厂时候，只需要把它分配给CN01就可以了，而不必再定义一套记账规则。
	19、除了工厂，另一个决定不同的会计科目的因素是物料本身，此处我们在物料主数据中定义一个“评估类”参数，通过“评估类”来决定会计科目。
		本处我们使用标准评估类：3000原材料、3100贸易商品、7920成品。
	20、这时可以进行原材料主数据的录入了（mmr1）。填入相应的采购组、物料组MRP控制者、计划边际码等。
	21、随后新建贸易商品主数据mmh1。
	22、新建产成品主数据mmf1。
	23、创建完各种物料后，可以在mm60中显示物料主记录清单。
	24、创建供应商的采购数据mk01。创建的时候要填采购组织，账户组，账户组是在FI的时候创建的。
		供应商的采购数据是和具体的采购组织相关的，也就是说不同的采购组织向同一个供应商采购，可以有不同的规定。
	25、新建采购信息记录Me11。采购信息记录包括信息如标准订单数量，净价，几天内交货，由哪个采购组负责等。
		保存这样的数据，可以方便实际采购时候参照使用。
	26、设置SAP中最为重要的集成配置之一，即物料移动在SAP中如何自动找到会计科目完成自动记账。
	27、将存货科目设置为只能自动记账，在fs00中实现。
	28、SAP在处理采购订单时，会检查采购订单中的价格和物料主数据的成本价格差异有多大，同时也会检查采购订单中的现金折扣是否可接受。
		如果差异超过一定的荣差，系统会发出警告消息或者错误信息。
		不同的容差检查存放在“容差码”中，容差码“PE”是检查价格的，“SE”是检查现金折扣的。这里复制0001公司的采购价格差异的容差限制。
	29、SAP允许采购订单定价数量单位和采购订单数量单位有所不同。比如采购订单数量是按件，但定价是按斤。
		这种情况下，收货的时候，两种单位的数量都要输入。在收货的时候，系统会检查定价数量和采购订单中的差异。
		这里通过复制0001的方式建立公司的收货容差限制。
	30、SAP系统在发票校验的时候会做大量检查，如果校验不通过发票就会被冻结。这里复制0110的容差检查。
	31、维护公司的项目全额检查。
	32、在md03中运行物料需求计划，md04可以显示库存/需求清单。（md05显示MRP清单）。
	33、这里计划部门手动创建采购申请（me51n）。根据采购申请，采购部门需要向供应商采购（me21n）。
	34、进行采购收货（MIGO）。（mb03 显示凭证；显示库存mmbe）
	35、供应商采购发票随后到达，在MIRO中输入发票，由于发票比采购订单原定的日期提前到达，并超过了荣差，所以发票被冻结了。
	36、被冻结的发票可以经过相关管理人员检查后手工下达，这里我们下达35步被冻结的发票。事物码MRBR。
	37、在MIR4中显示发票和会计凭证。
## 企业组织结构
----------
### 整体架构
	集团：是R/3系统里的一个商业的组织层次。有自己的数据、主记录及各种报表。
		从业务角度看，集团当作各个实体的组合。
	公司代码：一个公司代码代表一个独立的会计实体。
		每个公司代码都有它自己得到资产负债表和损益表。
	工厂：是公司内的组织单元，生产产品、提供服务或销售产品，工厂可以是（制造厂、仓库中转中心、 区域销售办公司、公司总部）
	仓储地点：是工厂内存放不同类型物料的组织单位，如：材料仓，成品仓，材损仓。
	采购组织：是负责为一个或多个工厂工厂采购物料和提供服务及与供应商协商价格和供货条款的主旨单位。
		 价格条件在采购组织层次设置。
		 如果一个采购组织为多个工厂采购，则价格在各个工厂都有效。
	采购组：是采购组织的进一步细分，负责日常的采购活动，一个采购组也可以为多个采购组织工作
### 集团/公司代码/工厂
![架构关系](https://i.imgur.com/siyRRCU.png)
### 公司代码/工厂/库存地点
![架构关系](https://i.imgur.com/fHh87jM.png)
## 物料主数据
----------
	包括哪些信息:
	  描述性信息：描述，尺寸，体积等
 	 控制性信息：MRP类型，价格控制，采购组等
	物料主数据：
	  General:           Material Number、Description、Base Unit Of Measure、Technical
	  Plan Specific：MRP type、Planned delivery time、Purchasing group、Batch indicator
	  Valuation：     Valuation price、Valuation procedure、Valuated quantity
       物料主数据记录中的数据是集合在不同的视图中；不同部门会有不同的物料主数据视图。
	1. 物料信息录入
	必须数据: 物料号：根据需求定义 
			行业领域：（控制哪些数据需要显示）
			物料类型：（群组，归类）：控制哪些部门需要维护
			    SPRO：SAP后台配置 => 后勤常规--->物料主数据--->基本设置--->物料类型--->定义物料类型的属性
					详细信息--->用户部门（决定哪些部门需要维护）
					控制内外部采购订单：决定是不是自己生产的（影响采购类型）
					控制账户分类参考：
					控制数量/价值更新：决定数量和价值的更新
			    客户供料：只会做数量更新，不会做价钱更新（不属于本公司）
				显示具体信息：设置显示（专家模式）
					成品（FERT）<Finished Product>
					半成品（HALB）<Semifinished Product>
					原材料（ROH）<Raw materials>
					备品备件（ERSA）<Spare Parts>
					贸易货物（HAWA）<Trading Goods>
					包装物料（VERP）<Packaging>
					可反复利用包装（LEIH）<Returnable packaging>
					未估价物料(UNBW)
					管线物料（PIPE）<Pipeline materials>
![视图](https://i.imgur.com/IkNyzGw.png)
![数据屏幕](https://i.imgur.com/OwYmXcr.png) 

2. 消耗型物料：办公材料<成本中心>，计算机系统<资产>    
		1. 消耗型物料时直接为了一个科目设置对象而购买的物料(不需要办理入库和出库手续)
		2. 库存管理未被执行
		3. 系统会自动更新有物料主记录的消耗型物料
		
		库存物料              《=》              消耗型物料
		输入要求的物料编号						可以输入物料编号，但不是必须的
		无科目设置类别							强制科目设置类别
		过账到库存科目							过账到消耗科目
		在物料主记录中更新数量和价值				消耗品更新（只使用于物料主记录中的物料）、
		移动平均价格被调整

		非库存物料（NLAG）: 有一定采购频率、是有物料主数据，但不做库存管理的物料。（价值，数量）。
			使用该物料类型（NLAG）的物料，创建采购订单需要指定账户分类（如K等）；
			根据采购订单收货时，直接财务上消耗记账。
		未评估物料（UNBW) : 做数量管理，不做价值管理
			使用该物料类型（UNBW）的物料，创建采购订单需要指定账户分类（如K等）；
			根据采购订单收货时，直接财务消耗记账，更新库存数量；消耗时，只记录库存数量减少。
	3. BOM：物料清单(零件结构表)，将产品的原材料、零配件、组件予以拆解，并将各单位项材料依材料编号、名称、 
	        规格、基本单位、单位用量、产品损耗等依制造流程的顺序记录下来，排列为一个清单，就是BOM。	
	4. MRP：物料需求计划，利用生产日程表（MPS）、零件结构表（BOM）、库存报表、已订购未交货订单等等
	        各种相关资料，经正确计算而得出各种物料零件的变量需求，提出各种新的订购或修正各种以开出订购
            的物料管理技术。
	5. 视图选择
		根据选择的部门不同，输入的内容也不同，系统自动识别所属类型.
			缺省值的设置。
				行业领域、选择视图、组织级别都可以设置缺省值。
			复制功能。
		基本数据1：一般属于物料描述等属性，属于集团类别。
			X单位：基本单位，订单单位，转换因子（附加数据中有计量单位的设定，
				    计量单位组：预先定义好单位转换<通过后台设置关键字 设置计量单位组中进行设置的>）
			X物料组：做分析会用到、可以利用不同的物料组决定种类分类账
			X旧物料号： 便于查找旧系统数据
			X部门：Division  (1)影响SD/FI两个模块  (2)无值将导致销售无法生成订单，单价录入，报告书等
			实验室/办公室：描述信息没有特殊描述
			X产品组：根据公司产品分组，不填写销售无法生成订单
			X附加数据：通过附加数据来维护不同语言环境的物料描述
					   凭证数据、内部批注、计量单位
			号码范围：通过后台维护 ---> 定义号码范围 （组 物料类型 定义号码范围）
					   外部给号，内部给号范围的限制。未检测的外部号分配
			X毛重、净重：报关使用
			
		销售组织数据1：
			X交货工厂编码：
			X税务数：国家，纳税类型
		销售组织数据2：影响销售订单
			分组条款：
				X物料定价组：（固定值）
				X科目设置组：
				X项目类别组：（固定值）
			物料组：X1，2，3，4，5
		销售一般/工厂：影响销售的订单
			工厂：工厂代码
			批次管理：（包装品必须勾选）
			运输组：
			装载组：
			利润中心：
		采购：
			采购组：用于区分资材类型（BOM、Non BOM）   报表所需
			批次管理：（勾选，HANON暂不使用）
			配额安排：同意物料对应多个供应商时用到此值（用分配的比例确定供应商的纳品数）
			源清单：物料与供应商信息的结合，不勾选，无法生成采购订单
		MRP1：MRP类型、MRP控制者、批量（在PP中会使用到的）
			MRP组：
			MRP类型：（固定值PD）
			MRP控制者：
			批量大小：（固定值EX）
		MRP2：影响MRP运算
			采购类型：内部生产或则外部采购
			特殊采购类型：有偿加工必填<31>,无偿加工品必填<30>
			外部采购仓储地点：物料存储仓库
			计划边际码：采购品须填写准确日期，影响MRP运输
			计划交货时间：进口件
		MRP3：可用性检查（02）
			策略组：内部生产品必填，固定值
		MRP4:
			选择方法：内部生产品必填，固定值
			重复生产：内部生产品必填，固定值
			重复生产参数 文件：内部生产品必填，固定值
		工厂数据/存储：
			存储条件：关系到销售出库
			End Item：直买直卖的物品必须勾选
		会计1：
			评估分类：影响会计计算，必须准确
			价格确定：系统自动存在，没有时必须输入
		成本1：
			勾选物料来源：
		主要视图：
			基础视图--物料基本描述（集团层次通用）-不同的工厂，不同公司看到的数据都是一样的
			采购视图--采购模块数据            
			销售视图--销售业务数据
			生产视图--MRP数据			  
			会计视图--财务会计数据
			成本视图--成本会计数据
			外部采购  与  计划交货时间（必输<采购提前期>）
		MRP：
			MRP1：MRP类型、MRP控制者、批量（在PP中会使用到的）
			MRP2：采购类型、计划交货时间、计划边际码
			MRP3：可用性检查（02）
			MRP4： 不输入
		会计1：
			评估类、价格控制、价格单位、标准价格
		后续可以不用输入。即可建立料号。
		Control string：material type、plant、industry sector、transaction、procurement indicator（采购类型）	
				通过字段选择-->维护数据屏幕的字段选择来修改屏幕的状态
	3. 组织层次：
		工厂，库存地点，销售机构，分销渠道
## 库存采购基础
----------
![采购环境](https://i.imgur.com/bgK3U1c.png)
	
	采购流程：
		1. Purch.Req(Determination of reqmts)（确认需求）
		2. Source determination      (购买方式和货源)
		3. Vendor selection		 （跟哪个供应商买）
		4. PO processing			（下采购订单）
		5. PO monitoring		    （订单跟踪）
		6. Goods receipt			（收货）
		7. Invoice verfication	  （发票校验）
		8. Payment processing   	（付钱）
	采购申请：
		物料使用部门提出的队某种物料的需求
		可以由系统自动生成(MRP)或手工生成
		公司内部谁用文件
		可以没有供应商、没有价格，只有评估价值
		可以自动或手动地转化为采购订单
	
	询价/报价：第一次购买的物料,为一种库存物料创建一张采购订单
	采购订单处理：参考采购订单输入一张物料接收，评估自动生成的各个凭证
	收货：输入与采购订单相关的收据，同时进行价格及质量检查
	检查供应商发票：核实在发票过账基础上创建的财务会计凭证，验证其可信程度	
	
询价单/报价单：ME41/ME47   <RFQ> 打印询价单：ME9A   价格对比：ME49  信息清单：ME11
	  1. 确定购买需求
	  2. 确定货源的供应
	  3. 向选定的多个供应商发送询价单（物料价格，物料数量，送货时间，等等）
	  4. 根据供应商返回的报价单挑选合适的(报价单处理：输入价格和条件，应用价格比较列表比较报价单)
	  5. 参照报价单创建采购订单
	  采购信息记录和价格决定：
		  1）手工输入价钱
		  2）如果手工没有输入，系统找Info record，如果信息记录中有合适的价钱，采用Info record价格。
		     没有，最后采用PO价钱，也可以不从最后的PO带入价格。
		  配额协议
		  货源清单(Source List)
		  信息记录(Info record)：ME11（手工输入，报价单，采购订单，框架协议更新）
			                            ：一个物料在某个供应商那里，卖多少钱，有什么特殊条件等信息的存储。
	  价格条件：
		  报价价格、采购订单、信息记录、框架协议会     （用到价格条件类型）
	  市场价：对个供应商的价格平均值，查询市场价<MEKH>
	
采购订单：将采购订单发送给供应商《同时发送给生产的工厂》产生采购凭证
		
	价钱条件：ME12
	手工创建采购订单：ME21N       
	跟踪采购订单：ME23N
	采购订单订单查询：ME2L
	一般数据：供应商数据、原始数据、订购单位等
	价格和条件：总价格、折扣、运费、关税、其他
	控制数据：交付时间、最小数量、容差
	文本：采购订单文本、Int.信息记录备注
	统计：价格历史记录、采购订单统计、改变历史记录. . . . . 

	订单结构：
		PR Header : 采购订单编号、供应商、货币、付款期限、采购订单日期
		PR Item : 物料编号、短文本、发货日期、采购订单数量、采购订单价格、分类
		科目设置对象：
			A：资产    K：成本中心    P：项目    F：订单(生产，考虑)    C：销售订单    其他
	无物料的采购订单：
		采购订单中不输入物料，只输入描述
		可以收获，但是必须是直接消耗，没有库存管理
		适用于低值品的采购			
	采购合同   <联系、集成、自动>   采购订单
自动采购：
	
	主数据和合同,资源清单
	物料需求计划(MRP)
	自动生成采购单
	发送通知和物料接收
	评估收货结算(ERS)
![采购订单的自动生成](https://i.imgur.com/wGlVuWf.png)

收货：事务代码 《MIGO》
    1. 供应商根据采购订单将货物发送到指定地区，以及发票
	  2. 工厂在收货地点进行收货
    3. 收货时同时产生物料凭证和会计凭证   	创建物料凭证：MB03
	  4. 货物会收到指定的Location   <货物移动凭证>
	   移动类型：仓库收货<101>、退货发运<122>. . . . . .
	收货后：
		1）会更新物料主数据的工厂库存视图  (库存查看 MMBE,  MB52)
		2）物料凭证，会计凭证产生
		3）自动触发启用 QM/WM
		4）采购订单历史数据更新
    
![收货的实现](https://i.imgur.com/5GIn3l3.png)
![凭证产生](https://i.imgur.com/4L2hYNE.png)
发票校验：
	1. 主数据、发票、采购订单、物料凭证综合数据进行发票校验
	2. 根据校验的结果生产发票凭证<发票校验科目>
	3. 记账过账处理
	4. 根据发票凭证触发付款程序
![发票校验】](https://i.imgur.com/f4ebX5V.png)
![发票信息](https://i.imgur.com/4TVHb2r.png)
记账过账：
	1.  根据采购订单、物料凭证、发票信息进行记账
	2.  发票过账时，会创建一张会计凭证。各项目将被发送到相应的科目。
